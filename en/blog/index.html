<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Blog - Omar Badr</title>
  
  <link rel="stylesheet" href="../../style.css">
  <link rel="stylesheet" href="blog-page.css">
  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-Q56ET619WZ"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-Q56ET619WZ');
  </script>
</head>
<body>

  <header>
    <div class="container">
      <nav>
        <a href="/en/">Home</a>
        <a href="/en/services/">Services</a>
        <a href="/en/portfolio/">Projects</a>
        <a href="/en/blog/" class="active">Blog</a>
        <a href="/en/about/">About</a>
        <a href="/en/contact/">Contact</a>
        <a href="/ar/blog/" class="language-switcher">العربية</a>
      </nav>
    </div>
  </header>

  <main class="container">
    <section class="blog-hero">
      <h1 class="page-title">Data Insights Hub</h1>
      <p class="page-subtitle">Here I share my thoughts, analyses, and tutorials in the world of data. A place to learn and grow together.</p>
    </section>

    <!-- ===== Controls (Search & Filter) ===== -->
    <div class="blog-controls">
        <div class="search-bar">
            <input type="text" id="search-input" placeholder="Search for an article...">
            <i class="fas fa-search"></i>
        </div>
        <div class="tags-filter" id="tags-filter-container">
            <!-- Tags will be created here by JavaScript -->
        </div>
    </div>

    <!-- ===== Featured Post ===== -->
    <section class="featured-post-section">
        <h2 class="section-title-alt">Latest Articles</h2>
        <div id="featured-post-container"></div>
    </section>
    
    <!-- ===== All Posts ===== -->
    <section class="all-posts-section">
        <h2 class="section-title-alt">All Articles</h2>
        <div class="blog-grid" id="other-posts-container"></div>
    </section>

    <!-- ===== Newsletter ===== -->
    <section class="newsletter-cta">
        <div class="newsletter-content">
            <h3>Stay Updated</h3>
            <p>Subscribe to the monthly newsletter to get the latest articles and insights delivered straight to your inbox.</p>
            <form class="newsletter-form">
                <input type="email" placeholder="Enter your email" required>
                <button type="submit" class="cta-button">Subscribe Now</button>
            </form>
        </div>
    </section>

  </main>

  <footer>
    <div class="container">
      <p>© 2025 Omar Badr | All Rights Reserved</p>
    </div>
  </footer>

  <script>
    document.addEventListener('DOMContentLoaded', async () => {
        const featuredContainer = document.getElementById('featured-post-container');
        const othersContainer = document.getElementById('other-posts-container');
        const tagsContainer = document.getElementById('tags-filter-container');
        const searchInput = document.getElementById('search-input');
        let allPosts = [];

        try {
            const response = await fetch('../blog-posts.json');
            if (!response.ok) throw new Error('Network response was not ok');
            allPosts = await response.json();
        } catch (error) {
            console.error('Error fetching blog posts:', error);
            othersContainer.innerHTML = '<p>An error occurred while loading the articles.</p>';
            return;
        }

        const createPostHTML = (post, isFeatured = false) => {
            const tagsHTML = post.tags.map(tag => `<span>${tag}</span>`).join('');
            let authorHTML = `<span><i class="fas fa-user"></i> By: Omar Badr</span>`;
            if (post.author && post.author.name) {
              authorHTML = `<span><i class="fas fa-user"></i> By: <a href="${post.author.linkedin}" target="_blank" rel="noopener noreferrer" class="author-link">${post.author.name}</a></span>`;
            }

            if (isFeatured) {
                return `
                <div class="featured-post-card">
                    <a href="/en/${post.link}" class="featured-post-image-link">
                        <img src="../${post.image}" alt="${post.title}" class="featured-post-image">
                    </a>
                    <div class="featured-post-content">
                        <div class="post-card-tags">${tagsHTML}</div>
                        <h3 class="featured-post-title"><a href="/en/${post.link}">${post.title}</a></h3>
                        <p class="post-card-excerpt">${post.excerpt}</p>
                        <div class="post-card-meta">
                            ${authorHTML}
                            <span><i class="fas fa-calendar-alt"></i> ${post.date}</span>
                            <span><i class="fas fa-clock"></i> ${post.readTime}</span>
                        </div>
                    </div>
                </div>`;
            } else {
                return `
                <div class="blog-post-card">
                    <a href="/en/${post.link}" class="post-card-image-link">
                        <img src="../${post.image}" alt="${post.title}" class="post-card-image">
                    </a>
                    <div class="post-card-content">
                        <div class="post-card-tags">${tagsHTML}</div>
                        <h3 class="post-card-title"><a href="/en/${post.link}">${post.title}</a></h3>
                        <div class="post-card-meta">
                            <span><i class="fas fa-calendar-alt"></i> ${post.date}</span>
                            <span><i class="fas fa-clock"></i> ${post.readTime}</span>
                        </div>
                    </div>
                </div>`;
            }
        };

        const displayPosts = (postsToDisplay) => {
            if (postsToDisplay.length === 0) {
                othersContainer.innerHTML = '<p>No articles match your search.</p>';
                featuredContainer.innerHTML = '';
                document.querySelector('.featured-post-section').style.display = 'none';
                return;
            }

            const [latestPost, ...otherPosts] = postsToDisplay;
            featuredContainer.innerHTML = createPostHTML(latestPost, true);
            othersContainer.innerHTML = otherPosts.map(post => createPostHTML(post, false)).join('');
            document.querySelector('.featured-post-section').style.display = 'block';
        };
        
        const populateTags = () => {
            const allTags = new Set(allPosts.flatMap(post => post.tags));
            let tagsHTML = '<button class="tag-button active" data-tag="all">All Topics</button>';
            allTags.forEach(tag => {
                tagsHTML += `<button class="tag-button" data-tag="${tag}">${tag}</button>`;
            });
            tagsContainer.innerHTML = tagsHTML;
        };

        displayPosts(allPosts);
        populateTags();

        tagsContainer.addEventListener('click', (e) => {
            if (e.target.classList.contains('tag-button')) {
                document.querySelectorAll('.tag-button').forEach(btn => btn.classList.remove('active'));
                e.target.classList.add('active');

                const selectedTag = e.target.getAttribute('data-tag');
                searchInput.value = '';

                if (selectedTag === 'all') {
                    displayPosts(allPosts);
                } else {
                    const filteredPosts = allPosts.filter(post => post.tags.includes(selectedTag));
                    featuredContainer.innerHTML = '';
                    document.querySelector('.featured-post-section').style.display = 'none';
                    othersContainer.innerHTML = filteredPosts.map(post => createPostHTML(post, false)).join('');
                }
            }
        });
        
        searchInput.addEventListener('input', (e) => {
            const searchTerm = e.target.value.toLowerCase();
            document.querySelectorAll('.tag-button').forEach(btn => btn.classList.remove('active'));

            if (!searchTerm) {
                displayPosts(allPosts);
                document.querySelector('.tag-button[data-tag="all"]').classList.add('active');
                return;
            }
            
            const filteredPosts = allPosts.filter(post => 
                post.title.toLowerCase().includes(searchTerm) || 
                post.excerpt.toLowerCase().includes(searchTerm)
            );
            
            featuredContainer.innerHTML = '';
            document.querySelector('.featured-post-section').style.display = 'none';
            othersContainer.innerHTML = filteredPosts.map(post => createPostHTML(post, false)).join('');
        });
    });
  </script>
</body>
</html>
